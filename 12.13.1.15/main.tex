\documentclass[journal,12pt,two column]{IEEEtran}
%\usepackage{setspace}
\usepackage{amssymb}
\usepackage[cmex10]{amsmath}
\usepackage{amsthm}
\usepackage[export]{adjustbox}
\usepackage{bm}
\def\inputGnumericTable{} 
\usepackage[latin1]{inputenc}                                 
\usepackage{color}                                            
\usepackage{array} 
\usepackage{longtable} 
\usepackage{calc}                                             
\usepackage{multirow}                                         
\usepackage{hhline}                                           
\usepackage{ifthen}  
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{listings}
\usepackage{color}                                            %%
\usepackage{array}                                            %%
\usepackage{caption} 
\usepackage{graphicx}
\usepackage[latin1]{inputenc}                                 
\usepackage{color}                                            
\usepackage{array}                                            
\usepackage{longtable}                                        
\usepackage{calc}                                             
\usepackage{multirow}                                         
\usepackage{hhline}                                           
\usepackage{ifthen}  

\renewcommand\thesection{\arabic{section}}
\renewcommand\thesubsection{\thesection.\arabic{subsection}}
\renewcommand\thesubsubsection{\thesubsection.\arabic{subsubsection}}

\renewcommand\thesectiondis{\arabic{section}}
\renewcommand\thesubsectiondis{\thesectiondis.\arabic{subsection}}
\renewcommand\thesubsubsectiondis{\thesubsectiondis.\arabic{subsubsection}}
\title{Assignment}
\author{Barath surya M \\ EE22BTECH11014}

% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}
\def\inputGnumericTable{}                                 %%

\lstset{
%language=C,
frame=single, 
breaklines=true,
columns=fullflexible
}
%\lstset{
%language=tex,
%frame=single, 
%breaklines=true
%}


\providecommand{\pr}[1]{\ensuremath{\Pr\left(#1\right)}}
\providecommand{\prt}[2]{\ensuremath{p_{#1}^{\left(#2\right)} }}        % own macro for this question
\providecommand{\qfunc}[1]{\ensuremath{Q\left(#1\right)}}
\providecommand{\sbrak}[1]{\ensuremath{{}\left[#1\right]}}
\providecommand{\lsbrak}[1]{\ensuremath{{}\left[#1\right.}}
\providecommand{\rsbrak}[1]{\ensuremath{{}\left.#1\right]}}
\providecommand{\brak}[1]{\ensuremath{\left(#1\right)}}
\providecommand{\lbrak}[1]{\ensuremath{\left(#1\right.}}
\providecommand{\rbrak}[1]{\ensuremath{\left.#1\right)}}
\providecommand{\cbrak}[1]{\ensuremath{\left\{#1\right\}}}
\providecommand{\lcbrak}[1]{\ensuremath{\left\{#1\right.}}
\providecommand{\rcbrak}[1]{\ensuremath{\left.#1\right\}}}
\newcommand{\sgn}{\mathop{\mathrm{sgn}}}
\providecommand{\abs}[1]{\left\vert#1\right\vert}
\providecommand{\res}[1]{\Res\displaylimits_{#1}} 
\providecommand{\norm}[1]{\left\lVert#1\right\rVert}
%\providecommand{\norm}[1]{\lVert#1\rVert}
\providecommand{\mtx}[1]{\mathbf{#1}}
\providecommand{\mean}[1]{E\left[ #1 \right]}
\providecommand{\cond}[2]{#1\middle|#2}
\providecommand{\fourier}{\overset{\mathcal{F}}{ \rightleftharpoons}}
%\providecommand{\hilbert}{\overset{\mathcal{H}}{ \rightleftharpoons}}
%\providecommand{\system}{\overset{\mathcal{H}}{ \longleftrightarrow}}
 %\newcommand{\solution}[2]{\textbf{Solution:}{#1}}
\newcommand{\solution}{\noindent \textbf{Solution: }}
\newcommand{\cosec}{\,\text{cosec}\,}
\providecommand{\dec}[2]{\ensuremath{\overset{#1}{\underset{#2}{\gtrless}}}}
\newcommand{\myvec}[1]{\ensuremath{\begin{pmatrix}#1\end{pmatrix}}}
\newcommand{\mydet}[1]{\ensuremath{\begin{vmatrix}#1\end{vmatrix}}}
\providecommand{\rank}{\text{rank}}
\providecommand{\pr}[1]{\ensuremath{\Pr\left(#1\right)}}
\providecommand{\qfunc}[1]{\ensuremath{Q\left(#1\right)}}
 \newcommand*{\permcomb}[4][0mu]{{{}^{#3}\mkern#1#2_{#4}}}
\newcommand*{\perm}[1][-3mu]{\permcomb[#1]{P}}
\newcommand*{\comb}[1][-1mu]{\permcomb[#1]{C}}
\providecommand{\qfunc}[1]{\ensuremath{Q\left(#1\right)}}
\providecommand{\gauss}[2]{\mathcal{N}\ensuremath{\left(#1,#2\right)}}
\providecommand{\diff}[2]{\ensuremath{\frac{d{#1}}{d{#2}}}}
\providecommand{\myceil}[1]{\left \lceil #1 \right \rceil }
\newcommand\figref{Fig.~\ref}
\newcommand\tabref{Table~\ref}
\newcommand{\sinc}{\,\text{sinc}\,}
\newcommand{\rect}{\,\text{rect}\,}
%%
% %\newcommand{\solution}[2]{\textbf{Solution:}{#1}}
%\newcommand{\solution}{\noindent \textbf{Solution:

%\newcommand{\cosec}{\,\text{cosec}\,}
%\numberwithin{equation}{section}
%\numberwithin{equation}{subsection}
%\numberwithin{problem}{section}
%\numberwithin{definition}{section}
%\makeatletter
%\@addtoreset{figure}{problem}
%\makeatother

%\let\StandardTheFigure\thefigure
\let\vec\mathbf

\begin{document}
\maketitle
Consider the experiment of throwing a die. If a multiple of 3 comes up, throw the die again. If any other number comes up, toss a coin. Find the conditional probability of the event the coin shows a tail, given that  at least one die shows a 3.\\
\solution
\begin{table}[ht!]
	\input{tables/table}
\end{table}
Let, the states $S_0$ and $S_1$ describe the outcomes of dice throws.\\
$S_2$ and $S_3$ describe the outcomes of coin toss.
Conditional Probability is that "The coin shows tails" given that "at least one die shows a 3".
Since, a Markov chain does not depend on the past outcomes,
\begin{align}
    p_{S_3 | S_0}&=\pr{X_n=S_3|X_1 =S_0}
\end{align}
Transition Probability Matrix is given as,
\begin{align}
    \vec{P}&=\myvec{\frac{1}{3}&0&0&0\\
                    \frac{2}{3}&0&0&0\\
                    0&\frac{1}{2}&1&0\\
                    0&\frac{1}{2}&0&1
                }
\end{align}
The state vector is defined as,
\begin{align}
	\vec{Q_n}=\myvec{p_{S_0}^n\\p_{S_1}^n\\p_{S_2}^n\\p_{S_3}^n}
\end{align}
where $p_{S_i}^n$ is the probability of $S_i$ state after n time interval from initial state.\\
The given conditon is "3 occurs at least once", and we let occurrence of 3 as the initial state, Since Markov chain does not depend on past outcomes. So, $\pr{X=S_0}=1$ and 0 for all other states.\\
And State vector is ,
\begin{align}
    \vec{Q_0}=\myvec{1\\0\\0\\0}
\end{align}
the state vector after one step in time can be written as,
\begin{align}
    \vec{Q_1}&=\vec{P Q_0}\\
    \vec{Q_2}&=\vec{P Q_1}\\
    \vdots\\
    \vec{Q_{n}}&=\vec{P Q_{n-1}}
\end{align}
we can see that the markov chain is reducible, a unique state vector exists and it is equal to limiting distribution.i.e, after a long time,
\begin{align}
	\vec{Q_n}=\vec{Q_{n-1}}
\end{align}
substituting the chain of state vectors, we get
\begin{align}
    \vec{Q_{n}}&=\vec{P^n Q_0}
\end{align}
applying limits to find the stationary probability vector,
\begin{align}
     \lim_{n \to \infty} \vec{Q_{n}}&=\vec{Q}=\vec{P^n Q_0}
\end{align} \label{eq:steady}
We can find $Q$ using eigenvector and eigenvalues.
Now, to find the eigenvalues, let $\lambda$ be the eigen value for the Transition Probability matrix.
\begin{align}
	\implies |\vec{P} -\lambda \vec{I}|&=0\\
	\myvec{\frac{1}{3} -\lambda&0&0&0\\
                    \frac{2}{3}&0 - \lambda&0&0\\
                    0&\frac{1}{2}&1- \lambda&0\\
                    0&\frac{1}{2}&0&1-\lambda
                }&=0\\
                \brak{\frac{1}{3}-\lambda}\brak{1-\lambda}^2 \brak{-\lambda}&=0\\
                \implies \lambda&=\frac{1}{3},0,1,1
\end{align} 
Now, to find eigenvector,
\begin{align}
	\brak{\vec{P}-\lambda \vec{I_4}}\vec{X}=\vec{0}
\end{align}
where $X$ is the eigen vector coresponding to eigen value $\lambda$ , using row reduction\\
$\implies \lambda =\frac{1}{3}$
\begin{align}
	\vec{X}&=\myvec{\frac{-2}{3}\\\frac{-4}{3}\\1\\1}
\end{align}
$\implies \lambda =0$
\begin{align}
	\vec{X}&=\myvec{0\\-2\\1\\1}
\end{align}
and for $\implies \lambda = 1$, using row echelon form,
\begin{align}
	\vec{X}&=\myvec{0\\0\\1\\0}
\end{align}
also
\begin{align}
	\vec{X}&=\myvec{0\\0\\0\\1}
\end{align}
then the eigenvector matrix is ,
\begin{align}
	\vec{S}&=\myvec{\frac{-2}{3}&0&0&0\\
	\frac{-4}{3}&-2&0&0\\
	1&1&1&0\\
	1&1&0&1}
\end{align}
Diagonal matrix $\vec{D}$ is,
\begin{align}
	\vec{D}=\myvec{\frac{1}{3}&0&0&0\\
	0&0&0&0\\
	0&0&1&0\\
	0&0&0&1}
\end{align} 
It is said that,
\begin{align}
	\vec{P}&=\vec{S}\vec{D}\vec{S}^{-1}\\
	\implies \vec{P}^n&=\vec{S}\vec{D}^n \vec{S}^{-1}\\
	\implies \lim_{n \to \infty} \vec{P}^n&=\vec{S} \vec{D}^n \vec{S}^{-1}
\end{align}
finding as $n \to \infty$ , value of $\vec{D}$
\begin{align}
	\lim_{n \to \infty} \vec{D}^n&=\myvec{\brak{\frac{1}{3}}^n &0&0&0\\
	0&0&0&0\\
	0&0&1^n&0\\
	0&0&0&1^n}\\
	&=\myvec{0&0&0&0\\
	0&0&0&0\\
	0&0&1&0\\
	0&0&0&1}
\end{align}
and value of $\vec{S}^{-1}$ is 
\begin{align}
	\vec{S}^{-1}=\myvec{\frac{-3}{2}&0&0&0\\
	                     1&\frac{-1}{2}&0&0\\
	                     \frac{1}{2}&\frac{1}{2}&1&0\\
	                     \frac{1}{2}&\frac{1}{2}&0&1}
\end{align}
by substititing the values,
\begin{align}	
	\lim _{n \to \infty}\vec{P}^n&=\vec{S}\vec{D}^n \vec{S}^{-1}\\
	&=\myvec{0&0&0&0\\0&0&0&0\\\frac{1}{2}&\frac{1}{2}&1&0\\ \frac{1}{2}&\frac{1}{2} &0&1}
\end{align}
By substituting the values of $Q_0$ and $P_\infty$ in the above equation, We get the steady state probability vector as,
\begin{align}
    \vec{Q}&=\myvec{0&0&0&0\\0&0&0&0\\\frac{1}{2}&\frac{1}{2}&1&0\\\frac{1}{2}&\frac{1}{2}&0&1}\myvec{1\\0\\0\\0}\\
    &=\myvec{0\\0\\\frac{1}{2}\\\frac{1}{2}}
\end{align}
So, the probability that "coin shows tails" given that "Die shows at least one 3" is,
\begin{align}
    p_{3|1} &= \frac{1}{2}
\end{align}
\begin{figure}[ht!]
    \centering
    \resizebox{\linewidth}{!}{\input{figs/Figure}}
    \caption{State diagram generated using LatexTikZ}
    \label{fig:Statediagramdiecoin}
\end{figure}
\end{document}
